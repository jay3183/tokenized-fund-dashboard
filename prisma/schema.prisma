// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model User {
  id       String    @id @default(cuid())
  name     String
  holdings Holding[]
}

model Fund {
  id            String         @id @default(cuid())
  name          String
  chainId       String
  assetType     String
  currentNav    Float
  intradayYield Float
  totalAum      Float
  inceptionDate DateTime?
  navHistory    NAVSnapshot[]
  yieldHistory  YieldHistory[]
  auditLogs     AuditLog[]
  portfolios    Portfolio[]
  holdings      Holding[]
}

model Holding {
  id     String @id @default(cuid())
  units  Float
  fundId String
  userId String
  fund   Fund   @relation(fields: [fundId], references: [id])
  user   User   @relation(fields: [userId], references: [id])
}

model Portfolio {
  id         String @id @default(cuid())
  investorId String
  fundId     String
  shares     Float
  fund       Fund   @relation(fields: [fundId], references: [id])
}

model NAVSnapshot {
  id        String   @id @default(cuid())
  fundId    String
  nav       Float
  timestamp DateTime
  source    String
  fund      Fund     @relation(fields: [fundId], references: [id])
}

model YieldHistory {
  id        String   @id @default(cuid())
  fundId    String
  yield     Float
  timestamp DateTime
  fund      Fund     @relation(fields: [fundId], references: [id])
}

model AuditLog {
  id        String   @id @default(cuid())
  actor     String
  action    String
  target    String
  timestamp DateTime
  metadata  Json
  fundId    String
  fund      Fund     @relation(fields: [fundId], references: [id])
}
